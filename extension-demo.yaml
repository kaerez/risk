# Extension Demo Definition File
# Extension file name must be: extension.yaml
# This file defines the rules and modifiers for various extensions.
TLP: CLEAR # Default TLP
hide: "none" # "none" to show all, you can include item/section. can also be added inside the extension before/under the version and at the top level before the extensions. E.g. ["Supplemental Metrics", "Environmental (Security Requirements)", "MSC", "MSI"]
disable: "none" # "none" to enable all, you can include item/section. can also be added inside the extension before/under the version and at the top level before the extensions. E.g. "MSA"
default_ext: ["SFDC", "1.0"] # Default extension and version to use if no extension is selected (e.g. initial load without CVSS vector string).

extensions:
  SFDC:
    TLP: AMBER # Example of TLP for versions without a TLP
    hide: ["Supplemental Metrics", "Environmental (Security Requirements)", "MSC", "MSI"]
    disable: "MSA"
    "1.0":
      TLP: GREEN # TLP for this version of SFDC
      metrics:
        AKC:
          name: "Attack Kill Chain"
          help: "Plausible (regardless of difficulty/skill) attack kill chain?"
          help_true: "Attack kill chain is plausible"
          help_false: "Attack kill chain is not plausible"
          type: BOOL # Type BOOL implies values of T/F
          if_true:
            math: MUL
            val: 0.1
          if_false:
            math: MUL
            val: -0.1
        KEV:
          name: "Known Exploited Vulnerability"
          help: "Published in CISA KEV?"
          help_true: "Published in CISA KEV"
          help_false: "Not published in CISA KEV"
          type: BOOL
          if_true:
            math: MUL
            val: 0.05
          if_false:
            math: MUL
            val: 0
        EXT:
          name: "Exposed Externally"
          help: "Externally exposed (directly or indirectly), proxies and firewalls are irrelevant. If an inbound payload reaches a system the response is True (T)."
          help_true: "If an inbound payload reach a system the response is True (T)."
          help_false: "If an inbound payload DOES NOT reach a system the response is False (F)."
          type: BOOL
          if_true:
            math: MUL
            val: 0.04
          if_false:
            math: MUL
            val: -0.04
        ICTS:
          name: "Impact Cross Tenant or Service"
          help: "Impact Cross Tenant or Service"
          help_true: "Possible Impact: Cross Tenant or Service"
          help_false: "No Possible Impact: Cross Tenant or Service"
          type: BOOL
          if_true:
            math: MUL
            val: 0.06
          if_false:
            math: MUL
            val: -0.06
        CLA:
          name: "Data Classification"
          help: "Data Classification of direct/indirect system/data (whichever is higher). Full value definitions are available in SFSS-019: https://btegrc.lightning.force.com/lightning/n/Browse_Catalog?c__doc=SFSS-019"
          type: [MC, RE, CO, IN, PU]
          values:
            MC:
              help: "Mission-Critical Data is Data that is critical to the continued success of Salesforce and is key to the companyâ€™s survivability. This Data is almost always restricted by law, regulation, NDA, and/ or contract (e.g., MSA and/or DPA) and must only be shared with customers, partners, and others under prior internal authorization and adequate contractual arrangement.  Data under this classification is not to be shared within Salesforce without the consent of the Data (Business) Owner and should never be shared outside of Salesforce. Access to this Data must be very limited to only those needing it to perform their job duties."
              math: MUL
              val: 0.2
            RE:
              help: "Restricted Data is Data that is likely to be restricted by law, regulation, NDA, and/or contract (e.g.,MSA and/or DPA) and must only be shared with customers, partners, and others under prior internal authorization and adequate contractual arrangement. Data under this classification is not to be shared within or outside of Salesforce without the consent of the Data (Business) Owner. Access to this Data must be limited to only those needing it to perform their job duties."
              math: MUL
              val: 0.1
            CO:
              help: "Confidential Data may be restricted by law, regulation, and/or contract (e.g., MSA and/or DPA) and should only be shared with customers, partners, and others under prior adequate contractual arrangement or on an as-needed basis with those who must have it to perform their job duties."
              math: MUL
              val: 0
            IN:
              help: "Internal Data is Data that is appropriate for viewing or use by all Salesforce employees and/or Contingent Workers. Internal Data may be restricted by law, regulation, and/or contract (e.g.,MSA and/or DPA) and is not meant to be broadcast publicly but can be shared with customers, partners, and others under prior adequate contractual arrangement."
              math: MUL
              val: -0.1
            PU:
              help: "Public Data is Data that is meant for public use. Public Data is meant to be viewed, but not altered, by the public."
              math: MUL
              val: -0.2
        SFDC_RISK: # Example of a metric with a custom list of values
          name: "Business Risk"
          type: [HIGH, MED, LOW]
          values:
            HIGH:
              help: "What high means" # Example showing the on hover help when hovering over high button
              math: ADD
              val: 0.5
            MED:
              math: ADD
              val: 0.2
            LOW:
              math: ADD
              val: 0
      combos:
        - name: "AKC and EXT"
          conditions:
            - metric: AKC
              value: T
            - metric: EXT
              value: T
          modifier:
            math: ADD
            val: 0.8
        - name: "AKC, EXT, and KEV"
          conditions:
            - metric: AKC
              value: T
            - metric: EXT
              value: T
            - metric: KEV
              value: T
          modifier:
            math: ADD
            val: 0.85
        - name: "EXT and KEV"
          conditions:
            - metric: EXT
              value: T
            - metric: KEV
              value: T
          modifier:
            math: ADD
            val: 0.5
        - name: "ICTS and AKC"
          conditions:
            - metric: ICTS
              value: T
            - metric: AKC
              value: T
          modifier:
            math: ADD
            val: 0.8
        - name: "RISK is HIGH or MED, and EXT is True"
          conditions:
            - metric: SFDC_RISK
              value: [HIGH, MED] # This implies an OR condition for the value
            - metric: SFDC_EXT
              value: T
          modifier:
            math: ADD
            val: 0.9 # Example value
    "1.1": # Example of another version for the same extension
      metrics:
        SFDC_AKC: # Metric might have different values in a new version
          name: "Attacker Knowledge of Code"
          type: BOOL
          if_true:
            math: MUL
            val: 0.12
          if_false:
            math: MUL
            val: -0.12
      combos: {} # This version might have no combos yet

  EXAMPLE_EXT: # Example of another extension
    "1.0":
      metrics:
        EXAMPLE_FLAG:
          name: "Example Flag"
          type: BOOL
          if_true:
            math: ADD
            val: 0.5
          if_false:
            math: ADD
            val: 0
      combos: {}
